import axios from 'axios';\n\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'https://apidecor.kelolahrd.life';\n\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// ==========================================\n// AUTHENTICATION\n// ==========================================\n\nexport const apiRegister = async (userData: any) => {\n  const { data } = await api.post('/api/auth/register', userData);\n  return data;\n};\n\nexport const apiLogin = async (email: string, password: string) => {\n  const { data } = await api.post('/api/auth/login', { email, password });\n  if (!data.success) throw new Error(data.error);\n  return data.user;\n};\n\nexport const apiLogout = () => {\n  localStorage.removeItem('user');\n  localStorage.removeItem('token');\n};\n\nexport const apiLoginWithGoogleCredential = async () => {\n  // Simulate Google login for now\n  return {\n    id: `user-${Date.now()}`,\n    fullName: 'Google User',\n    email: 'google.user@example.com',\n    phone: '',\n    city: '',\n    avatarUrl: 'https://ui-avatars.com/api/?name=Google+User&background=random',\n    vehicles: []\n  };\n};\n\n// ==========================================\n// OTP VERIFICATION\n// ==========================================\n\nexport const apiSendWhatsAppOTP = async (phoneNumber: string) => {\n  const { data } = await api.post('/api/otp/whatsapp/send', { phoneNumber });\n  return data;\n};\n\nexport const apiSendEmailOTP = async (email: string) => {\n  const { data } = await api.post('/api/otp/email/send', { email });\n  return data;\n};\n\nexport const apiVerifyOTP = async (identifier: string, otp: string) => {\n  const { data } = await api.post('/api/otp/verify', { identifier, otp });\n  return data;\n};\n\n// ==========================================\n// FUEL STATIONS\n// ==========================================\n\nexport const apiGetStations = async (lat: number, lng: number, radius = 10000) => {\n  const { data } = await api.get(`/api/stations?lat=${lat}&lng=${lng}&radius=${radius}`);\n  return data.data;\n};\n\nexport const apiGetStationDetails = async (id: string) => {\n  const { data } = await api.get(`/api/station/${id}`);\n  return data.data;\n};\n\n// ==========================================\n// ORDERS\n// ==========================================\n\nexport const apiCreateOrder = async (orderData: any) => {\n  const { data } = await api.post('/api/orders', orderData);\n  return data.data;\n};\n\nexport const apiGetOrders = async (customerId?: string) => {\n  const url = customerId ? `/api/orders?customerId=${customerId}` : '/api/orders';\n  const { data } = await api.get(url);\n  return data.data;\n};\n\nexport const apiGetOrderTracking = async (orderId: string) => {\n  const { data } = await api.get(`/api/orders/${orderId}/track`);\n  return data.data;\n};\n\n// ==========================================\n// PAYMENTS (STRIPE)\n// ==========================================\n\nexport const apiCreatePaymentIntent = async (amount: number, orderId: string, currency = 'gbp') => {\n  const { data } = await api.post('/api/stripe/create-payment-intent', {\n    amount,\n    orderId,\n    currency\n  });\n  return data;\n};\n\nexport const apiCreateStripeCustomer = async (email: string, name: string) => {\n  const { data } = await api.post('/api/stripe/create-customer', { email, name });\n  return data;\n};\n\nexport const apiSavePaymentMethod = async (customerId: string, paymentMethodId: string) => {\n  const { data } = await api.post('/api/stripe/save-payment-method', {\n    customerId,\n    paymentMethodId\n  });\n  return data;\n};\n\n// ==========================================\n// NOTIFICATIONS\n// ==========================================\n\nexport const apiSendOrderNotification = async (phoneNumber: string, orderDetails: any) => {\n  const { data } = await api.post('/api/whatsapp/send-order-notification', {\n    phoneNumber,\n    orderDetails\n  });\n  return data;\n};\n\nexport const apiSendDeliveryUpdate = async (phoneNumber: string, updateDetails: any) => {\n  const { data } = await api.post('/api/whatsapp/send-delivery-update', {\n    phoneNumber,\n    updateDetails\n  });\n  return data;\n};\n\n// ==========================================\n// UTILITY FUNCTIONS\n// ==========================================\n\nexport const apiHealthCheck = async () => {\n  const { data } = await api.get('/api/health');\n  return data;\n};\n\nexport const apiSeedDatabase = async () => {\n  const { data } = await api.post('/api/seed');\n  return data;\n};\n\n// ==========================================\n// GEOCODING\n// ==========================================\n\nexport const apiGeocode = async (address: string) => {\n  try {\n    const response = await fetch(\n      `https://nominatim.openstreetmap.org/search?format=json&limit=1&q=${encodeURIComponent(address)}`,\n      {\n        headers: {\n          'User-Agent': 'FuelFriendly/1.0'\n        }\n      }\n    );\n    const data = await response.json();\n    if (data.length > 0) {\n      return {\n        lat: parseFloat(data[0].lat),\n        lng: parseFloat(data[0].lon),\n        display_name: data[0].display_name\n      };\n    }\n    throw new Error('Address not found');\n  } catch (error) {\n    console.error('Geocoding error:', error);\n    throw error;\n  }\n};\n\n// ==========================================\n// ERROR HANDLING\n// ==========================================\n\napi.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    console.error('API Error:', error.response?.data || error.message);\n    \n    if (error.response?.status === 401) {\n      // Unauthorized - clear auth data\n      apiLogout();\n      window.location.href = '/login';\n    }\n    \n    return Promise.reject(error);\n  }\n);\n\nexport default api;